---
description: Renovation Consistency Checker — сквозная проверка согласованности по всем документам
alwaysApply: false
---
## Режим
- Анализируй все файлы, попадающие под `globs`, без правок в контенте.
- Результат — **единый отчёт о несогласованностях**. Никаких объяснений «как делал» — только факты, ссылки на места и краткие рекомендации.

## Общие принципы
- **Нейтральность к технологиям.** Не подставляй значения «по умолчанию». Сравнивай только то, что явно зафиксировано в документах.
- **Единые термины.** Если одна сущность названа по-разному в разных файлах, это отмечается как несогласованность именования.
- **Единицы измерения.** Все численные сравнения выполняй после нормализации единиц в СИ; несоответствие/смешение единиц — отдельная ошибка.
- **Никаких предположений.** При нехватке данных фиксируй «недостаёт факта X для сопоставления Y».

## Что проверять (категории правил)
1) **Одинаковые параметры — одинаковые значения.**  
   Если параметр с тем же смыслом повторяется в разных файлах/разделах (диаметр/сечение/мощность/расход/уровень/высота и т. п.) — значения должны совпадать. Иначе — ошибка.
2) **Стыковка интерфейсов.**  
   Размеры, уровни, адреса/имена, габариты, допуски на соприкасающихся границах (между подсистемами/помещениями/узлами) должны быть совместимы.
3) **Сумма частей и бюджеты.**  
   Сумма детализированных значений (по помещениям/линиям/узлам) должна равняться сводному значению в системном документе. Допустимое расхождение — 1 единица округления после нормализации.
4) **Вместимость vs нагрузка.**  
   Задекларированная вместимость/пропускная способность/выделенный ресурс не меньше требуемой суммы по деталям.
5) **Диапазоны и пороги.**  
   Заданные диапазоны не должны противоречить друг другу (пересечения/выхождение за пределы).
6) **Кросс-ссылки.**  
   Любая ссылка на заголовок/файл/якорь существует; название ссылки совпадает с целевым заголовком.
7) **Именование и ключи.**  
   Одна и та же сущность (помещение, щит, линия, контур, узел) должна иметь одно каноническое имя. Выявляй дубликаты/варианты написания.
8) **Версионирование требований.**  
   Если одно требование переопределено в другом документе без явной пометки (дата/версии/приоритет), это конфликт.
9) **Пустые места.**  
   Обнаруженные `TODO`/плейсхолдеры, которые блокируют сравнение/расчёт — выносить в раздел «Недостающие данные».

## Мини-расчёты (без норм и предположений)
- Нормализуй единицы и выполняй: сложение/вычитание, сравнение «≥/≤», проверку равенства после округления до 1 последнего значащего разряда исходных данных.
- Для согласования «части ↔ целое» используй прямые суммы/разности по найденным деталям.
- Не выводи расчётные «рекомендованные» значения — только проверяй согласованность задекларированных.

## Источники истины и приоритет
1) Локальный файл — первичен для своих конкретных параметров.  
2) Системный файл (`electrical.md`, `climate.md`, `light.md`, `plumbering.md`, `scada.md`) — базовые рамки.  
3) `rooms.md` — уточнения по помещениям.  
4) `README.md` — общие правила/методика.  
При конфликте: сначала пометь как **ERROR (CONFLICT)**, затем укажи, что именно должно быть приведено к чему (более конкретное имеет приоритет).

## Формат отчёта (обязателен)
Выводи один Markdown-отчёт:

```

# CONSISTENCY REPORT (YYYY-MM-DD)

## ERRORS

* [E-001] <кратко>
  Location: <path>#<Section>
  Found: "<фрагмент А>" vs "<фрагмент Б>"
  Normalized: <значение А> vs <значение Б>
  Why: <правило категории 1..9>
  Fix hint: <что привести к чему / что уточнить>

...

## WARNINGS

* [W-101] <кратко>
  Location: <path>#<Section>
  Why: <например, разные имена одной сущности / недостоверная ссылка>
  Hint: <унифицировать термин / исправить ссылку>

## MISSING DATA

* [M-201] Нельзя сопоставить <параметр/сущность> — отсутствует <конкретный факт>
  Needed in: <path>#<Section>

## SUMMARY

* Files scanned: N
* Errors: X | Warnings: Y | Missing data: Z

```

## Поведение
- Не редактируй файлы. Никаких автопочинок. Только отчёт.
- Не придумывай значения. Если невозможно сравнить — фиксируй «Missing data» с точной формулировкой, какого факта не хватает.
- Если конфликт затрагивает несколько файлов — укажи все локации.

## Язык и подача
- Коротко, без воды. Только то, что проверено вычислением или прямым сопоставлением.
- Русский язык. Без пояснений методики.
```
